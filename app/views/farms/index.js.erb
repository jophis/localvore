<% if params[:search] && params[:page].nil? %>
$('#farms').html("<%= j (render @farms) %>");
<% elsif params[:longitude] && params[:latitude] %>
$('#farms').html("<%= j (render @farms) %>");
<% else %>
$('#farms').append("<%= j (render @farms) %>");
<% end %>


coords = <%= raw @farms.map { |f| { latitude: f.latitude.to_f, longitude: f.longitude.to_f, infoWindow: (render partial: "info_window", locals: {farm: f})}}.to_json %>
	
map.setCenter(new google.maps.LatLng(<%= params[:latitude]%> , <%= params[:longitude]%>));
map.setZoom(10);
addMarkers(coords, 0);