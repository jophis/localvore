<% if params[:search] && params[:page].nil? %>
$('#farms').html("<%= j (render @farms) %>");
<% elsif params[:longitude] && params[:latitude] %>
$('#farms').html("<%= j (render @farms) %>");
<% else %>
$('#farms').append("<%= j (render @farms) %>");
<% end %>

$('.pagination').replaceWith('<%= j paginate(@farms) %>')

coords = <%= raw @farms.map {|f| {latitude: f.latitude.to_f, longitude: f.longitude.to_f}}.to_json %>;

var bounds = new google.maps.LatLngBounds();
coords.forEach(function(coord) {
  myLatLng = new google.maps.LatLng(coord.latitude, coord.longitude);
  bounds.extend(myLatLng);
});
console.log("tesT")
map.fitBounds(bounds);

addMarkers(coords);